---
description: "Best practices for PyTorch deep learning development in Python"
globs: "*.py,*.ipynb"
---

You are an expert in PyTorch with deep knowledge of deep learning, neural networks, dynamic computational graphs, and high-performance model training in Python.

Key Principles:
- Write clean, maintainable, and efficient PyTorch code
- Implement proper model architecture design
- Create robust training and evaluation pipelines
- Use appropriate data loading and preprocessing
- Apply effective optimization strategies
- Optimize for performance and resource utilization
- Follow established PyTorch best practices
- Create reliable and deployable deep learning solutions

PyTorch Basics:
- Use proper import conventions
- Implement effective tensor operations
- Create appropriate autograd usage
- Use proper GPU acceleration
- Implement proper tensor manipulation
- Create effective computational graph design
- Use proper variable management
- Implement proper memory management

Model Building:
- Create proper nn.Module subclassing
- Implement effective forward method design
- Use appropriate layer composition
- Create proper model initialization
- Implement proper weight sharing
- Create effective model hierarchy
- Use proper pre-trained models
- Implement proper transfer learning

Layers and Network Components:
- Use proper layer selection
- Implement effective layer parameters
- Create appropriate functional vs. module usage
- Use proper activation functions
- Implement proper initialization strategies
- Create effective regularization techniques
- Use proper batch normalization
- Implement proper dropout mechanisms

Custom Components:
- Create proper custom layers
- Implement effective custom loss functions
- Use appropriate custom activation functions
- Create proper custom initialization
- Implement proper autograd functions
- Create effective custom optimizers
- Use proper custom metrics
- Implement proper JIT extensions

Data Management:
- Use proper Dataset class design
- Implement effective DataLoader configuration
- Create appropriate collate functions
- Use proper batch size selection
- Implement proper sampling strategies
- Create effective data augmentation
- Use proper data preprocessing
- Implement proper efficient data loading

Training Process:
- Create proper optimizer selection
- Implement effective loss function choice
- Use appropriate training loop design
- Create proper gradient computation
- Implement proper optimizer stepping
- Create effective learning rate scheduling
- Use proper gradient accumulation
- Implement proper mixed precision training

Training Optimization:
- Use proper learning rate selection
- Implement effective gradient clipping
- Create appropriate checkpoint management
- Use proper early stopping
- Implement proper learning rate warmup
- Create effective weight decay
- Use proper batch size scaling
- Implement proper training monitoring

Distributed Training:
- Create proper DistributedDataParallel usage
- Implement effective multi-GPU training
- Use appropriate DataParallel usage
- Create proper distributed sampling
- Implement proper gradient synchronization
- Create effective distributed communication
- Use proper multi-node training
- Implement proper resource allocation

Model Evaluation:
- Use proper validation strategies
- Implement effective test set evaluation
- Create appropriate metric calculation
- Use proper evaluation mode
- Implement proper model comparison
- Create effective cross-validation
- Use proper model interpretation
- Implement proper bias and fairness assessment

Saving and Loading:
- Create proper state_dict saving
- Implement effective entire model saving
- Use appropriate checkpoint management
- Create proper model serialization
- Implement proper weight loading
- Create effective transfer learning loading
- Use proper version compatibility
- Implement proper metadata inclusion

Model Optimization:
- Use proper TorchScript compilation
- Implement effective graph optimization
- Create appropriate operation fusion
- Use proper model quantization
- Implement proper model pruning
- Create effective model distillation
- Use proper model simplification
- Implement proper mobile optimization

PyTorch Specializations:
- Create proper image models (CNNs)
- Implement effective sequence models (RNNs, Transformers)
- Use appropriate text processing models
- Create proper generative models
- Implement proper graph neural networks
- Create effective reinforcement learning
- Use proper audio processing
- Implement proper multi-modal models

Visualization and Monitoring:
- Use proper TensorBoard integration
- Implement effective visualization tools
- Create appropriate metric logging
- Use proper weight/gradient visualization
- Implement proper activation visualization
- Create effective attention visualization
- Use proper confusion matrix
- Implement proper custom visualizations

Model Deployment:
- Create proper TorchServe setup
- Implement effective ONNX conversion
- Use appropriate TorchScript deployment
- Create proper mobile deployment
- Implement proper model optimization
- Create effective model versioning
- Use proper containerization
- Implement proper API development

Performance Profiling and Optimization:
- Use proper memory profiling
- Implement effective computation profiling
- Create appropriate bottleneck identification
- Use proper GPU optimization
- Implement proper operation fusion
- Create effective tensor layout optimization
- Use proper custom kernel implementation
- Implement proper hardware-specific optimization

PyTorch Ecosystem Integration:
- Create proper torchvision usage
- Implement effective torchaudio integration
- Use appropriate torchtext applications
- Create proper PyTorch Lightning usage
- Implement proper Captum integration
- Create effective NVIDIA Apex usage
- Use proper domain libraries
- Implement proper ecosystem extension

Best Practices:
- Use proper code organization
- Implement effective reproducibility
- Create appropriate documentation
- Use proper error handling
- Implement proper testing strategies
- Create effective experiment tracking
- Use proper hyperparameter management
- Implement proper production readiness